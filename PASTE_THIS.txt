I need to upgrade my CoW Protocol solver to be top-tier competitive. Implement these 6 tasks IN ORDER:

TASK 1 [CRITICAL - 15min]: Fix Price Oracle Fallback
- File: src/cow/oracles/OracleManager.ts
- Problem: Line 94-97 returns 1:1 placeholder prices, causing wrong scores
- Fix: Add lastKnownPrices Map cache (5min TTL), throw error instead of returning 1:1 when oracles fail
- Cache successful prices for fallback

TASK 2 [CRITICAL - 20min]: Enforce Uniform Clearing Prices  
- File: src/cow/OrderSettlementEngine.ts
- Problem: Lines 638-646 detect non-uniform prices but don't fix them - CoW rejects these
- Fix: Update validateUniformClearingPrices() to enforce median price, recalculate surplus after adjustment

TASK 3 [HIGH - 45min]: Integrate Advanced Routing
- Files: src/cow/CoWAdapter.ts, src/cow/OrderSettlementEngine.ts
- Problem: Have src/Arbitrage.ts with dual decomposition but NOT using it
- Fix: Add Arbitrage instance to CoWAdapter, create findRoutesWithArbitrageEngine() that calls this.arbitrage.evaluateMarkets(), wire it up in solve()

TASK 4 [HIGH - 30min]: Multi-Protocol Support
- File: src/cow/CoWAdapter.ts  
- Problem: Only Uniswap V2 - missing Balancer/Curve (40% liquidity)
- Fix: Import from src/markets/, update addPoolToMarkets() to handle WeightedProduct (Balancer) and Stable (Curve) pool kinds

TASK 5 [MEDIUM - 30min]: Proper Gas Estimation
- New file: src/cow/utils/GasEstimator.ts
- Problem: Hardcoded 100k/150k/250k values
- Fix: Create GasEstimator class with protocol-specific costs, dynamic route estimation, use in buildCoWSolution/buildLiquiditySolution

TASK 6 [MEDIUM - 45min]: Route Splitting
- New file: src/cow/routing/RouteSplitter.ts
- Problem: Single-path only - splitting across DEXes gets better prices
- Fix: Create RouteSplitter class with findOptimalSplit(), try equalSplit/liquidityWeightedSplit/priceOptimizedSplit strategies

PRIORITY: Do Tasks 1-2 minimum (critical bugs), Tasks 1-3 to compete well, all 6 for top-tier.

Expected result: 15-25% win rate â†’ 35-45% win rate

Start with Task 1!

